<!DOCTYPE html>
<html xmlns="https://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
  <head>
    <!-- for Google -->
    <meta name="google-site-verification" content="ZeiyLEq0pBT9mOrskrWweTuwTZ9ti2HJoPOOe1SVyok" />
    <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-52384290-1', 'auto');
  ga('send', 'pageview');

</script>
    
    <meta charset="utf-8">
    <link rel="alternate" href="/atom.xml" type="application/atom+xml" title="rpk.io Feed">

    <!-- FB Pixel-->
    <script>
      !function(f,b,e,v,n,t,s)
      {if(f.fbq)return;n=f.fbq=function(){n.callMethod?
      n.callMethod.apply(n,arguments):n.queue.push(arguments)};
      if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
      n.queue=[];t=b.createElement(e);t.async=!0;
      t.src=v;s=b.getElementsByTagName(e)[0];
      s.parentNode.insertBefore(t,s)}(window, document,'script',
      'https://connect.facebook.net/en_US/fbevents.js');
      fbq('init', '277361612776878');
      fbq('track', 'PageView');
    </script>

    <script src="https://unpkg.com/@lyket/widget@latest/dist/lyket.js?apiKey=e476c6d9f24c48b3eac4ef27aad0bf"></script>

    <noscript><img height="1" width="1" style="display:none"
      src="https://www.facebook.com/tr?id=277361612776878&ev=PageView&noscript=1"
    /></noscript>

    <title>
      
        Automatically create HTML posts in Jekyll with Thor | indicator0.github.io
      
    </title>

    <meta name="description" content="Waldo Yang's Photography.">

    <meta name="author" content="indicator0.github.io" />
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

    <!-- for Facebook -->
    <meta property="og:site_name" content="indicator0.github.io" />
    <meta property="og:title" content="Automatically create HTML posts in Jekyll with Thor" />
    <meta property="fb:admins" content="100006320713108">

    
      <meta property="og:url" content="https://indicator0.github.io/posts/automatically-create-html-posts-in-jekyll-with-thor/" />
    

    
      <meta property="og:type" content="article" />
    

    
      <meta property="og:image" content="/images/posts/jekyll_thor/thor_hammer.png" />
    

    
      
        <meta property="article:tag" content="Programming" />
      
    

    
      <meta property="og:description" content="The Problem

This article is the sequel to the the previous Thor automation tutorial posted some months ago.

In the photography section of this blog I post photo essays, a photo-essay (or photogra..." />
    

    <!-- for Twitter -->
    
      <meta name="twitter:card" content="summary">
    

    <meta name="twitter:site" content="@waldo" />
    <meta name="twitter:creator" content="@waldo" />

    
      <meta name="twitter:title" content="Automatically create HTML posts in Jekyll with Thor">
    

    
      <meta property="og:description" content="The Problem

This article is the sequel to the the previous Thor automation tutorial posted some months ago.

In the photography section of this blog I post photo essays, a photo-essay (or photogra..." />
    

    
      
        <meta name="twitter:image:src" content="/images/posts/jekyll_thor/thor_hammer.png">
      
    
    
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">

    <link rel="stylesheet" href="/css/base.css" type="text/css" media="screen, projection" />
    <link rel="stylesheet" href="/css/pygments.css" type="text/css" />
    <link rel="stylesheet" href="/css/font-awesome.min.css" type="text/css" />

    <link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro' rel='stylesheet' type='text/css'>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.0/jquery.min.js"></script>

    <script async src="/js/lightbox-2.6.min.js"></script>
    <link href="/css/lightbox.css" rel="stylesheet"/>

    

    <script>
      $(document).ready(function(){
       $('.menu-icon').on('click', function() {
        $(this).toggleClass('active');
       });

       $('.menu-icon').on('click', function() {
        $('.sidebar').toggleClass('toggle');
       });
      });
    </script>
  </head>

  <body>
    <a href="" rel="publisher"></a>
    <section class="sidebar">

      <a href="/" class="name">
        <!--span></span>-->
        <small>Waldo Yang</small>
        <em>&#x1f4f7;</em>
        <small>Photography</small>
      </a>

      <ul class="menu">
        
        
          

          

            <li><a  href="/">Photo essays</a></li>
        
          

          

            <li><a  href="/posts/">Posts</a></li>
        
          

          

            <li><a  href="/about/">About</a></li>
        
      </ul>

      <ul class="meta">
        <li>
          <a href="https://instagram.com/waldoschaeffer" target="_blank">
            <i class="fa fa-instagram"></i>
          </a>
        </li>
        <li>
          <a href="https://www.facebook.com/zhihao.yang.92" target="_blank">
            <i class="fa fa-facebook"></i>
          </a>
        </li>
        <li>
          <a href="https://twitter.com/waldo" target="_blank">
            <i class="fa fa-twitter"></i>
          </a>
        </li>
      </ul>

      <div class="menu-icon">
        <i></i>
      </div>

    </section>
    <a href="/" class="name">
      <div class="menu-icon-bg">RPK</div>
    </a>

    <section class="content posts">
  <div class="inner-center">
    <h1 class="inner-heading">
      <a href="/posts/automatically-create-html-posts-in-jekyll-with-thor">Automatically create HTML posts in Jekyll with Thor</a>
    </h1>

    <section class="byline">
      November 27, 2014
    </section>

    <h2 id="the-problem">The Problem</h2>

<p><sup>This article is the sequel to the <a href="https://rpk.io/posts/automatically-create-jekyll-posts-with-thor">the previous Thor automation tutorial</a> posted some months ago.<sup></sup></sup></p>

<p>In the photography section of this blog I post photo essays, a photo-essay (or photographic essay) is a set or series of photographs that are intended to tell a story or evoke a series of emotions in the viewer.</p>

<p>So it is very important to display the images in the best possible way.
Doing this is very difficult as the style varies from essay to essay 
and from device to device. 
Posts written in Markdown made it too difficult to customize the presentation so I decided to create manually the HTML files for each post.</p>

<p>This is <strong>time consuming</strong> and <strong>repeatable</strong> process so why not automate it too as we do with the blog posts?</p>

<p>For this task we have to work on three things</p>

<ol>
  <li>Dynamically generate the photo list with <em>Liquid templating language</em></li>
  <li>Choose where to upload the images</li>
  <li>Write a Thor script to generate the HTML file</li>
</ol>

<h2 id="the-solution">The Solution</h2>

<h3 id="1-we-have-to-minimize-and-optimize-the-default-html-file-of-each-photo-essay">1. We have to minimize and optimize the default HTML file of each photo essay</h3>

<p>Each photo set is a list of, normally, more than 5 images, using liquid we can generate the huge HTML list with just a few lines of code.</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;ul&gt;</span>
  { % for img in page.images % }
    <span class="nt">&lt;li&gt;&lt;a</span> <span class="na">href=</span><span class="s">"/uploads/--folder_name--/"</span> <span class="na">data-lightbox=</span><span class="s">"image-1"</span><span class="nt">&gt;&lt;img</span> <span class="na">src=</span><span class="s">"/uploads/--folder_name--/"</span><span class="na">alt=</span><span class="s">""</span> <span class="nt">/&gt;&lt;/a&gt;&lt;/li&gt;</span>
  { % endfor % }
<span class="nt">&lt;/ul&gt;</span>
</code></pre></div></div>

<p>The rest of the file consists of three elements one section with the icons and general info, one blockquote for the intro essay and last a div with the next project links.</p>

<h3 id="2-the-images-will-be-uploaded-to-github">2. The images will be uploaded to GitHub</h3>

<p>This site is hosted in <a href="https://pages.github.com/">GitHub Pages</a> so it is very convenient to upload the images there. I use a separate folder for each photo essay with the title of the post.</p>

<h3 id="3-the-script">3. The script</h3>

<p>The Thor script has 2 major changes compared to the one used for the <a href="https://rpk.io/posts/automatically-create-jekyll-posts-with-thor">blog post</a> generation.</p>

<ul>
  <li>The attributes passed via a interactive prompt after running the script.</li>
  <li>The fileâ€™s content it is not generated inside the script but it copies a sample post and replaces the keywords in it based on the input.</li>
</ul>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="c1">#!/usr/bin/env ruby</span>
  <span class="c1">#!/usr/bin/env ruby</span>
  <span class="nb">require</span> <span class="s1">'fileutils'</span>
  <span class="nb">require</span> <span class="s1">'thor'</span>

  <span class="k">class</span> <span class="nc">PhotoPost</span> <span class="o">&lt;</span> <span class="no">Thor</span>
    <span class="kp">include</span> <span class="no">Thor</span><span class="o">::</span><span class="no">Actions</span>

    <span class="n">no_commands</span> <span class="k">do</span>
      <span class="k">def</span> <span class="nf">directories_exists?</span><span class="p">(</span><span class="n">dir1</span><span class="p">,</span> <span class="n">dir2</span><span class="p">)</span>
        <span class="no">File</span><span class="p">.</span><span class="nf">directory?</span><span class="p">(</span><span class="n">dir1</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="no">File</span><span class="p">.</span><span class="nf">directory?</span><span class="p">(</span><span class="n">dir2</span><span class="p">)</span>
      <span class="k">end</span>
    <span class="k">end</span>

    <span class="n">desc</span> <span class="s2">"create"</span><span class="p">,</span> <span class="s2">"Use the interactive prompt to create a new photo essay"</span>

    <span class="k">def</span> <span class="nf">create</span>
      <span class="n">say</span><span class="p">(</span><span class="s2">"New photo essay"</span><span class="p">,</span> <span class="no">Thor</span><span class="o">::</span><span class="no">Shell</span><span class="o">::</span><span class="no">Color</span><span class="o">::</span><span class="no">YELLOW</span><span class="p">)</span>

      <span class="n">photos_count</span> <span class="o">=</span> <span class="n">ask</span><span class="p">(</span><span class="s2">"Number of photos:"</span><span class="p">)</span>
      <span class="n">title</span> <span class="o">=</span> <span class="n">ask</span><span class="p">(</span><span class="s2">"Title:"</span><span class="p">)</span>
      <span class="n">path</span> <span class="o">=</span> <span class="n">ask</span><span class="p">(</span><span class="s2">"Folder name:"</span><span class="p">)</span>
      <span class="n">date</span> <span class="o">=</span> <span class="n">ask</span><span class="p">(</span><span class="s2">"Date (Nov 2014):"</span><span class="p">)</span>
      <span class="n">place</span> <span class="o">=</span> <span class="n">ask</span><span class="p">(</span><span class="s2">"Place:"</span><span class="p">)</span>
      <span class="n">camera</span> <span class="o">=</span> <span class="n">ask</span><span class="p">(</span><span class="s2">"Camera:"</span><span class="p">)</span>
      <span class="n">film</span> <span class="o">=</span> <span class="n">ask</span><span class="p">(</span><span class="s2">"Film:"</span><span class="p">)</span>
      <span class="n">next_project_title</span> <span class="o">=</span> <span class="n">ask</span><span class="p">(</span><span class="s2">"Next Project Title:"</span><span class="p">)</span>
      <span class="n">next_project_path</span> <span class="o">=</span> <span class="n">ask</span><span class="p">(</span><span class="s2">"Next Project Path:"</span><span class="p">)</span>
      <span class="n">description</span> <span class="o">=</span> <span class="n">ask</span><span class="p">(</span><span class="s2">"Description:"</span><span class="p">)</span>

      <span class="n">number_of_photos</span> <span class="o">=</span> <span class="s2">""</span>
      <span class="p">(</span><span class="mi">1</span><span class="o">..</span><span class="n">photos_count</span><span class="p">.</span><span class="nf">to_i</span><span class="p">).</span><span class="nf">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">l</span><span class="o">|</span>
        <span class="n">number_of_photos</span> <span class="o">&lt;&lt;</span> <span class="s2">"  - </span><span class="si">#{</span><span class="n">l</span><span class="si">}</span><span class="s2">.jpg</span><span class="se">\n</span><span class="s2">"</span>
      <span class="k">end</span>

      <span class="n">dirname</span> <span class="o">=</span> <span class="no">File</span><span class="p">.</span><span class="nf">dirname</span><span class="p">(</span><span class="s2">"../photos/</span><span class="si">#{</span><span class="n">path</span><span class="si">}</span><span class="s2">/index.html"</span><span class="p">)</span>
      <span class="n">uploads_dirname</span> <span class="o">=</span> <span class="no">File</span><span class="p">.</span><span class="nf">dirname</span><span class="p">(</span><span class="s2">"../uploads/</span><span class="si">#{</span><span class="n">path</span><span class="si">}</span><span class="s2">/image.jpg"</span><span class="p">)</span>

      <span class="k">if</span> <span class="n">directories_exists?</span><span class="p">(</span><span class="n">dirname</span><span class="p">,</span> <span class="n">uploads_dirname</span><span class="p">)</span>
        <span class="nb">puts</span> <span class="s2">"Photo essay with the same name already exists!"</span>
      <span class="k">else</span>
        <span class="no">FileUtils</span><span class="p">.</span><span class="nf">mkdir_p</span><span class="p">(</span><span class="n">dirname</span><span class="p">)</span>
        <span class="no">FileUtils</span><span class="p">.</span><span class="nf">mkdir_p</span><span class="p">(</span><span class="n">uploads_dirname</span><span class="p">)</span>
        <span class="n">temp</span> <span class="o">=</span> <span class="no">File</span><span class="p">.</span><span class="nf">read</span><span class="p">(</span><span class="s2">"sample_post"</span><span class="p">).</span>
          <span class="nf">gsub</span><span class="p">(</span><span class="sr">/--number_of_photos--/</span><span class="p">,</span> <span class="n">number_of_photos</span><span class="p">).</span>
          <span class="nf">gsub</span><span class="p">(</span><span class="sr">/--title--/</span><span class="p">,</span> <span class="n">title</span><span class="p">).</span>
          <span class="nf">gsub</span><span class="p">(</span><span class="sr">/--folder_name--/</span><span class="p">,</span> <span class="n">path</span><span class="p">).</span>
          <span class="nf">gsub</span><span class="p">(</span><span class="sr">/--date--/</span><span class="p">,</span> <span class="n">date</span><span class="p">).</span>
          <span class="nf">gsub</span><span class="p">(</span><span class="sr">/--place--/</span><span class="p">,</span> <span class="n">place</span><span class="p">).</span>
          <span class="nf">gsub</span><span class="p">(</span><span class="sr">/--camera--/</span><span class="p">,</span> <span class="n">camera</span><span class="p">).</span>
          <span class="nf">gsub</span><span class="p">(</span><span class="sr">/--film--/</span><span class="p">,</span> <span class="n">film</span><span class="p">).</span>
          <span class="nf">gsub</span><span class="p">(</span><span class="sr">/--next_project_title--/</span><span class="p">,</span> <span class="n">next_project_title</span><span class="p">).</span>
          <span class="nf">gsub</span><span class="p">(</span><span class="sr">/--next_project_path--/</span><span class="p">,</span> <span class="n">next_project_path</span><span class="p">).</span>
          <span class="nf">gsub</span><span class="p">(</span><span class="sr">/--description--/</span><span class="p">,</span> <span class="n">description</span><span class="p">)</span>
        <span class="no">File</span><span class="p">.</span><span class="nf">open</span><span class="p">(</span><span class="n">dirname</span> <span class="o">+</span> <span class="s2">"/index.html"</span><span class="p">,</span> <span class="s2">"w+"</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="n">out</span><span class="o">|</span>
          <span class="n">out</span> <span class="o">&lt;&lt;</span> <span class="n">temp</span>
        <span class="k">end</span>

        <span class="k">if</span> <span class="n">directories_exists?</span><span class="p">(</span><span class="n">dirname</span><span class="p">,</span> <span class="n">uploads_dirname</span><span class="p">)</span>
          <span class="n">say</span><span class="p">(</span><span class="s2">"Created &gt;&gt; </span><span class="si">#{</span><span class="n">dirname</span><span class="si">}</span><span class="s2">/index.html"</span><span class="p">,</span> <span class="no">Thor</span><span class="o">::</span><span class="no">Shell</span><span class="o">::</span><span class="no">Color</span><span class="o">::</span><span class="no">GREEN</span><span class="p">)</span>
          <span class="n">say</span><span class="p">(</span><span class="s2">"Created &gt;&gt; </span><span class="si">#{</span><span class="n">uploads_dirname</span><span class="si">}</span><span class="s2">"</span><span class="p">,</span> <span class="no">Thor</span><span class="o">::</span><span class="no">Shell</span><span class="o">::</span><span class="no">Color</span><span class="o">::</span><span class="no">GREEN</span><span class="p">)</span>
          <span class="n">say</span><span class="p">(</span><span class="s2">"Reminder: Add the photos to the uploads folder"</span><span class="p">,</span> <span class="no">Thor</span><span class="o">::</span><span class="no">Shell</span><span class="o">::</span><span class="no">Color</span><span class="o">::</span><span class="no">RED</span><span class="p">)</span>
        <span class="k">end</span>
      <span class="k">end</span>
    <span class="k">end</span>
  <span class="k">end</span>
</code></pre></div></div>

<p>Running the script:</p>

<script type="text/javascript" src="https://asciinema.org/a/14312.js" id="asciicast-14312" data-theme="solarized-dark" async=""></script>


      <div class="social-buttons">
    
      <p class="share">Share this post in:</p>
    
    <ul>
      <li>
        <a class="btn" href="https://twitter.com/intent/tweet?text=Automatically create HTML posts in Jekyll with Thor&url=https://indicator0.github.io/posts/automatically-create-html-posts-in-jekyll-with-thor&via=waldo&related=@waldo" rel="nofollow" target="_blank" title="Share on Twitter">Twitter</a>
      </li>
      <li>
        <a class="btn" href="https://facebook.com/sharer.php?u=https://indicator0.github.io/posts/automatically-create-html-posts-in-jekyll-with-thor" rel="nofollow" target="_blank" title="Share on Facebook">Facebook</a>
      </li>
      <li>
        <a class="btn" href="https://plus.google.com/share?url=https://indicator0.github.io/posts/automatically-create-html-posts-in-jekyll-with-thor" rel="nofollow" target="_blank" title="Share on Google+">Google+</a>
      </li>
    </ul>
  </div>


    <br>
    <!-- DISQUS 
    <section class="meta">
      <div id="disqus_thread"></div>
      <script type="text/javascript">
          var disqus_shortname = 'waldo';

          /* * * DON'T EDIT BELOW THIS LINE * * */
          (function() {
              var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
              dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
              (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
          })();
      </script>
      <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    </section>
  </div>
</section>
-->

  </body>
</html>
